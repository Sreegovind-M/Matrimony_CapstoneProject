<app-navbar></app-navbar>

<section class="event-details">
  <!-- LOADING STATE -->
  <div *ngIf="loading" class="event-state event-state--loading">
    <div class="skeleton hero"></div>
    <div class="skeleton title"></div>
    <div class="skeleton text"></div>
    <div class="skeleton text"></div>
  </div>

  <!-- ERROR STATE -->
  <div *ngIf="error && !loading" class="event-state event-state--error">
    <div class="event-state__icon">âš ï¸</div>
    <h3>Failed to load event details</h3>
    <p>Please check your connection and try again.</p>
    <div class="event-state__actions">
      <button class="btn btn--secondary" (click)="goBack()">Go Back</button>
      <button class="btn btn--primary" (click)="retry()">Retry</button>
    </div>
  </div>

  <!-- NOT FOUND STATE -->
  <div *ngIf="notFound && !loading" class="event-state event-state--empty">
    <div class="event-state__icon">ğŸ”</div>
    <h3>Event Not Found</h3>
    <p>This event does not exist or may have been removed.</p>
    <button class="btn btn--primary" (click)="goBack()">Back to Events</button>
  </div>

  <!-- SUCCESS STATE -->
  <div *ngIf="event && !loading && !error && !notFound" class="event-card">
    <!-- Hero Image -->
    <div class="event-hero">
      <img [src]="event.image_url || getDefaultImage(event.category_name)" [alt]="event.name" class="event-hero__image"
        (error)="$any($event.target).src = 'assets/events/tech_conference.png'" />
      <div class="event-hero__overlay">
        <span class="event-hero__badge">{{ event.category_name || 'Event' }}</span>
        <span *ngIf="event.is_featured" class="event-hero__featured">â­ Featured</span>
      </div>
    </div>

    <!-- Content -->
    <div class="event-content">
      <h1 class="event-title">{{ event.name }}</h1>

      <div class="event-meta">
        <div class="event-meta__item">
          <span class="icon">ğŸ“…</span>
          <span>{{ event.date_time | date : "EEEE, MMMM d, yyyy 'at' h:mm a" }}</span>
        </div>
        <div class="event-meta__item" *ngIf="event.end_date_time">
          <span class="icon">ğŸ</span>
          <span>Until {{ event.end_date_time | date : "MMM d, yyyy 'at' h:mm a" }}</span>
        </div>
        <div class="event-meta__item">
          <span class="icon">ğŸ“</span>
          <span>{{ event.venue }}</span>
        </div>
        <div class="event-meta__item" *ngIf="event.venue_address">
          <span class="icon">ğŸ—ºï¸</span>
          <span>{{ event.venue_address }}</span>
        </div>
        <div class="event-meta__item" *ngIf="event.organizer_name">
          <span class="icon">ğŸ‘¤</span>
          <span>Organized by {{ event.organizer_name }}</span>
        </div>
      </div>

      <section class="event-section">
        <h2>About this event</h2>
        <p>{{ event.description }}</p>
      </section>

      <section class="event-info">
        <div class="event-info__item">
          <strong>Category</strong>
          <span>{{ event.category_name || 'General' }}</span>
        </div>

        <div class="event-info__item">
          <strong>Total Capacity</strong>
          <span>{{ event.capacity }} attendees</span>
        </div>

        <div class="event-info__item">
          <strong>Available Seats</strong>
          <span class="seats-available">{{ getAvailableSeats() }} left</span>
        </div>

        <div class="event-info__item">
          <strong>Ticket Price</strong>
          <span *ngIf="event.ticket_price && event.ticket_price > 0" class="price">${{ event.ticket_price }}</span>
          <span *ngIf="!event.ticket_price || event.ticket_price === 0" class="price free">FREE</span>
        </div>
      </section>

      <div class="event-actions">
        <button class="btn btn--secondary" (click)="goBack()">
          â† Back to Events
        </button>
        <button class="btn btn--accent" (click)="bookTickets()" [disabled]="getAvailableSeats() === 0">
          {{ getAvailableSeats() > 0 ? 'ğŸŸï¸ Book Tickets' : 'Sold Out' }}
        </button>
      </div>
    </div>
  </div>
</section>